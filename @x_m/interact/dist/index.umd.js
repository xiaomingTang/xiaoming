(function(f,O){typeof exports=="object"&&typeof module!="undefined"?O(exports,require("@babel/runtime-corejs3/core-js-stable/reflect/construct"),require("core-js/modules/es.object.to-string.js"),require("@babel/runtime-corejs3/helpers/classCallCheck"),require("@babel/runtime-corejs3/helpers/createClass"),require("@babel/runtime-corejs3/helpers/assertThisInitialized"),require("@babel/runtime-corejs3/helpers/inherits"),require("@babel/runtime-corejs3/helpers/possibleConstructorReturn"),require("@babel/runtime-corejs3/helpers/getPrototypeOf"),require("@babel/runtime-corejs3/helpers/defineProperty"),require("@x_m/event-emitter"),require("@babel/runtime-corejs3/helpers/slicedToArray"),require("core-js/modules/web.dom-collections.for-each.js"),require("@x_m/event-emitter/src")):typeof define=="function"&&define.amd?define(["exports","@babel/runtime-corejs3/core-js-stable/reflect/construct","core-js/modules/es.object.to-string.js","@babel/runtime-corejs3/helpers/classCallCheck","@babel/runtime-corejs3/helpers/createClass","@babel/runtime-corejs3/helpers/assertThisInitialized","@babel/runtime-corejs3/helpers/inherits","@babel/runtime-corejs3/helpers/possibleConstructorReturn","@babel/runtime-corejs3/helpers/getPrototypeOf","@babel/runtime-corejs3/helpers/defineProperty","@x_m/event-emitter","@babel/runtime-corejs3/helpers/slicedToArray","core-js/modules/web.dom-collections.for-each.js","@x_m/event-emitter/src"],O):(f=typeof globalThis!="undefined"?globalThis:f||self,O(f.XM_Interact={},f._Reflect$construct,null,f._classCallCheck,f._createClass,f._assertThisInitialized,f._inherits,f._possibleConstructorReturn,f._getPrototypeOf,f._defineProperty,f.EventEmitter,f._slicedToArray,null,f.EventEmitter$1))})(this,function(f,O,oe,A,D,W,X,U,k,z,G,K,ae,N){"use strict";const p=u=>u&&typeof u=="object"&&"default"in u?u:{default:u},_=p(O),w=p(A),R=p(D),o=p(W),$=p(X),x=p(U),S=p(k),a=p(z),B=p(G),I=p(K),H=p(N);(function(u){if("InputDeviceCapabilities"in u||"sourceCapabilities"in UIEvent.prototype)return;function l(e){Object.defineProperty(this,"__firesTouchEvents",{value:e&&"firesTouchEvents"in e?e.firesTouchEvents:!1,writable:!1,enumerable:!1})}l.prototype={get firesTouchEvents(){return this.__firesTouchEvents}},u.InputDeviceCapabilities=l;var i=new l({firesTouchEvents:!0}),t=new l({firesTouchEvents:!1}),r;function s(e){r=Date.now()}document.addEventListener("touchstart",s,!0),document.addEventListener("touchmove",s,!0),document.addEventListener("touchend",s,!0),document.addEventListener("touchcancel",s,!0);var m="__inputDeviceCapabilitiesPolyfill_specifiedSourceCapabilities",n=["resize","error","load","unload","abort"],d=1e3;Object.defineProperty(UIEvent.prototype,"sourceCapabilities",{get:function(){if(m in this)return this[m];if(n.indexOf(this.type)>=0)return null;if(!("TouchEvent"in u))return t;if(this instanceof TouchEvent)return i;if("PointerEvent"in u&&this instanceof PointerEvent)return this.pointerType=="touch"?i:t;var e=Date.now()<r+d?i:t;return Object.defineProperty(this,m,{value:e,writable:!1}),e},configurable:!0,enumerable:!0});function y(e){if(e in u&&!(!("length"in u[e])||u[e].length<1)){var c=u[e];u[e]=function(b,E){var P=E&&E.sourceCapabilities?E.sourceCapabilities:null;E&&delete E.sourceCapabilities;var T=new c(b,E);return Object.defineProperty(T,m,{value:P,writable:!1}),T},u[e].prototype=c.prototype}}for(var v=["UIEvent","MouseEvent","TouchEvent","InputEvent","CompositionEvent","FocusEvent","KeyboardEvent","WheelEvent","PointerEvent"],h=0;h<v.length;h++)y(v[h]);var M=Document.prototype.createEvent;Document.prototype.createEvent=function(e){var c=M.call(this,e);if(c instanceof UIEvent)return Object.defineProperty(c,m,{value:null,writable:!1}),c}})(globalThis);function J(u){var l=Q();return function(){var t=S.default(u),r;if(l){var s=S.default(this).constructor;r=_.default(t,arguments,s)}else r=t.apply(this,arguments);return x.default(this,r)}}function Q(){if(typeof Reflect=="undefined"||!_.default||_.default.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(_.default(Boolean,[],function(){})),!0}catch(u){return!1}}var Z=function(u){$.default(i,u);var l=J(i);function i(t){var r,s,m,n,d,y,v,h,M,e;return w.default(this,i),e=l.call(this),a.default(o.default(e),"element",null),a.default(o.default(e),"isMoving",!1),a.default(o.default(e),"onMouseDown",function(c){var b;e.disabledWhenFiresTouchEvents&&(b=c.sourceCapabilities)!==null&&b!==void 0&&b.firesTouchEvents||!e.enableMove||c.button!==e.mouseButtonOfMove||(e.isMoving=!0)}),a.default(o.default(e),"onMouseMove",function(c){!e.enableMove||!e.isMoving||(c.preventDefault(),e.emit("move",{x:c.movementX*e.ratioOfMove,y:c.movementY*e.ratioOfMove}))}),a.default(o.default(e),"onMouseUp",function(){e.isMoving=!1}),a.default(o.default(e),"onWheel",function(c){var b={x:c.clientX,y:c.clientY};e.enableScale&&!!c.shiftKey==(e.mouseButtonOfScale==="shift-required")&&e.emit("scale",{ratio:c.deltaY>0?1/e.ratioOfScale:e.ratioOfScale,center:b}),e.enableRotate&&!!c.shiftKey!=(e.mouseButtonOfScale==="shift-required")&&e.emit("rotate",{ratio:c.deltaY>0?e.ratioOfRotate*Math.PI/180:-(e.ratioOfRotate*Math.PI)/180,center:b})}),a.default(o.default(e),"enableMove",void 0),a.default(o.default(e),"enableScale",void 0),a.default(o.default(e),"enableRotate",void 0),a.default(o.default(e),"mouseButtonOfMove",void 0),a.default(o.default(e),"mouseButtonOfScale",void 0),a.default(o.default(e),"ratioOfMove",void 0),a.default(o.default(e),"ratioOfScale",void 0),a.default(o.default(e),"ratioOfRotate",void 0),a.default(o.default(e),"disabledWhenFiresTouchEvents",void 0),e.enableMove=(r=t==null?void 0:t.enableMove)!==null&&r!==void 0?r:!0,e.enableScale=(s=t==null?void 0:t.enableScale)!==null&&s!==void 0?s:!0,e.enableRotate=(m=t==null?void 0:t.enableRotate)!==null&&m!==void 0?m:!0,e.ratioOfMove=(n=t==null?void 0:t.ratioOfMove)!==null&&n!==void 0?n:1,e.ratioOfScale=(d=t==null?void 0:t.ratioOfScale)!==null&&d!==void 0?d:1.1,e.ratioOfRotate=(y=t==null?void 0:t.ratioOfRotate)!==null&&y!==void 0?y:15,e.disabledWhenFiresTouchEvents=(v=t==null?void 0:t.disabledWhenFiresTouchEvents)!==null&&v!==void 0?v:!1,e.mouseButtonOfMove=(h=t==null?void 0:t.mouseButtonOfMove)!==null&&h!==void 0?h:0,e.mouseButtonOfScale=(M=t==null?void 0:t.mouseButtonOfScale)!==null&&M!==void 0?M:"middle-button-only",e}return R.default(i,[{key:"attach",value:function(r){if(!r){console.error("[interact] element required");return}this.element=r,window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp),r.addEventListener("mousedown",this.onMouseDown),r.addEventListener("wheel",this.onWheel)}},{key:"detach",value:function(){var r,s;window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),(r=this.element)===null||r===void 0||r.removeEventListener("mousedown",this.onMouseDown),(s=this.element)===null||s===void 0||s.removeEventListener("wheel",this.onWheel),this.element=null}}]),i}(B.default);function V(u){var l=ee();return function(){var t=S.default(u),r;if(l){var s=S.default(this).constructor;r=_.default(t,arguments,s)}else r=t.apply(this,arguments);return x.default(this,r)}}function ee(){if(typeof Reflect=="undefined"||!_.default||_.default.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(_.default(Boolean,[],function(){})),!0}catch(u){return!1}}function L(u,l){return{x:l.x-u.x,y:l.y-u.y}}function g(u,l){return Math.sqrt(Math.pow(u.x-l.x,2)+Math.pow(u.y-l.y,2))}function q(){for(var u=0,l=0,i=arguments.length,t=new Array(i),r=0;r<i;r++)t[r]=arguments[r];return t.forEach(function(s){u+=s.x,l+=s.y}),{x:u/t.length,y:l/t.length}}var te=function(u){$.default(i,u);var l=V(i);function i(t){var r,s,m,n;return w.default(this,i),n=l.call(this),a.default(o.default(n),"element",null),a.default(o.default(n),"hasTouchStart",!1),a.default(o.default(n),"touchAPos",{x:-1,y:-1}),a.default(o.default(n),"touchBPos",{x:-1,y:-1}),a.default(o.default(n),"syncTouches",function(d){var y=I.default(d.touches,2),v=y[0],h=y[1];v&&(n.touchAPos.x=v.clientX,n.touchAPos.y=v.clientY),h&&(n.touchBPos.x=h.clientX,n.touchBPos.y=h.clientY)}),a.default(o.default(n),"onTouchStart",function(d){n.hasTouchStart=!0,d.preventDefault(),n.syncTouches(d)}),a.default(o.default(n),"onGlobalTouchStart",function(d){n.hasTouchStart&&(d.preventDefault(),n.syncTouches(d))}),a.default(o.default(n),"onTouchMove",function(d){var y=I.default(d.touches,2),v=y[0],h=y[1];if(!(!v||!n.hasTouchStart)){if(n.enableMove)if(h){var M=v.clientX-n.touchAPos.x,e=h.clientX-n.touchBPos.x,c=M+e;n.enableScale&&(c/=2),M*e>0&&(c=Math.abs(M)<Math.abs(e)?M:e);var b=v.clientY-n.touchAPos.y,E=h.clientY-n.touchBPos.y,P=b+E;n.enableScale&&(P/=2),b*E>0&&(P=Math.abs(b)<Math.abs(E)?b:E),n.emit("move",{x:c,y:P})}else n.emit("move",{x:v.clientX-n.touchAPos.x,y:v.clientY-n.touchAPos.y});if(v&&h&&(n.enableRotate||n.enableScale)){var T={x:v.clientX,y:v.clientY},j={x:h.clientX,y:h.clientY};if(n.enableScale&&n.emit("scale",{center:q(T,j,n.touchAPos,n.touchBPos),ratio:g(T,j)/g(n.touchAPos,n.touchBPos)}),n.enableRotate){var F=L(T,j),Y=L(n.touchAPos,n.touchBPos),C=Math.atan2(F.y,F.x)-Math.atan2(Y.y,Y.x);C>Math.PI&&(C-=Math.PI*2),C<-Math.PI&&(C+=Math.PI*2),n.emit("rotate",{center:q(T,j),ratio:C})}}n.syncTouches(d)}}),a.default(o.default(n),"onTouchEnd",function(d){n.syncTouches(d),d.touches.length===0&&(n.hasTouchStart=!1)}),a.default(o.default(n),"enableMove",void 0),a.default(o.default(n),"enableScale",void 0),a.default(o.default(n),"enableRotate",void 0),n.enableMove=(r=t==null?void 0:t.enableMove)!==null&&r!==void 0?r:!0,n.enableScale=(s=t==null?void 0:t.enableScale)!==null&&s!==void 0?s:!0,n.enableRotate=(m=t==null?void 0:t.enableRotate)!==null&&m!==void 0?m:!0,n}return R.default(i,[{key:"attach",value:function(r){this.element=r,this.element.addEventListener("touchstart",this.onTouchStart,{passive:!1}),window.addEventListener("touchstart",this.onGlobalTouchStart,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove),window.addEventListener("touchend",this.onTouchEnd)}},{key:"detach",value:function(){var r;(r=this.element)===null||r===void 0||r.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchstart",this.onGlobalTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),this.element=null}}]),i}(H.default);function ne(u){var l=re();return function(){var t=S.default(u),r;if(l){var s=S.default(this).constructor;r=_.default(t,arguments,s)}else r=t.apply(this,arguments);return x.default(this,r)}}function re(){if(typeof Reflect=="undefined"||!_.default||_.default.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(_.default(Boolean,[],function(){})),!0}catch(u){return!1}}var ue=function(u){$.default(i,u);var l=ne(i);function i(){return w.default(this,i),l.apply(this,arguments)}return R.default(i)}(B.default);f.Interact=ue,f.MouseFormatter=Z,f.TouchFormatter=te,Object.defineProperties(f,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
