(function(d,S){typeof exports=="object"&&typeof module!="undefined"?S(exports,require("@babel/runtime-corejs3/core-js-stable/reflect/construct"),require("core-js/modules/es.object.to-string.js"),require("@babel/runtime-corejs3/helpers/classCallCheck"),require("@babel/runtime-corejs3/helpers/createClass"),require("@babel/runtime-corejs3/helpers/assertThisInitialized"),require("@babel/runtime-corejs3/helpers/inherits"),require("@babel/runtime-corejs3/helpers/possibleConstructorReturn"),require("@babel/runtime-corejs3/helpers/getPrototypeOf"),require("@babel/runtime-corejs3/helpers/defineProperty"),require("@x_m/event-emitter"),require("@babel/runtime-corejs3/helpers/slicedToArray"),require("core-js/modules/web.dom-collections.for-each.js"),require("@x_m/event-emitter/src")):typeof define=="function"&&define.amd?define(["exports","@babel/runtime-corejs3/core-js-stable/reflect/construct","core-js/modules/es.object.to-string.js","@babel/runtime-corejs3/helpers/classCallCheck","@babel/runtime-corejs3/helpers/createClass","@babel/runtime-corejs3/helpers/assertThisInitialized","@babel/runtime-corejs3/helpers/inherits","@babel/runtime-corejs3/helpers/possibleConstructorReturn","@babel/runtime-corejs3/helpers/getPrototypeOf","@babel/runtime-corejs3/helpers/defineProperty","@x_m/event-emitter","@babel/runtime-corejs3/helpers/slicedToArray","core-js/modules/web.dom-collections.for-each.js","@x_m/event-emitter/src"],S):(d=typeof globalThis!="undefined"?globalThis:d||self,S(d.XM_Interact={},d._Reflect$construct,null,d._classCallCheck,d._createClass,d._assertThisInitialized,d._inherits,d._possibleConstructorReturn,d._getPrototypeOf,d._defineProperty,d.EventEmitter,d._slicedToArray,null,d.EventEmitter$1))})(this,function(d,S,oe,A,W,X,D,U,k,z,G,K,ae,N){"use strict";const p=u=>u&&typeof u=="object"&&"default"in u?u:{default:u},b=p(S),O=p(A),R=p(W),s=p(X),x=p(D),B=p(U),M=p(k),c=p(z),I=p(G),$=p(K),H=p(N);(function(u){if("InputDeviceCapabilities"in u||"sourceCapabilities"in UIEvent.prototype)return;function i(f){Object.defineProperty(this,"__firesTouchEvents",{value:f&&"firesTouchEvents"in f?f.firesTouchEvents:!1,writable:!1,enumerable:!1})}i.prototype={get firesTouchEvents(){return this.__firesTouchEvents}},u.InputDeviceCapabilities=i;var a=new i({firesTouchEvents:!0}),t=new i({firesTouchEvents:!1}),r;function l(f){r=Date.now()}document.addEventListener("touchstart",l,!0),document.addEventListener("touchmove",l,!0),document.addEventListener("touchend",l,!0),document.addEventListener("touchcancel",l,!0);var h="__inputDeviceCapabilitiesPolyfill_specifiedSourceCapabilities",e=["resize","error","load","unload","abort"],v=1e3;Object.defineProperty(UIEvent.prototype,"sourceCapabilities",{get:function(){if(h in this)return this[h];if(e.indexOf(this.type)>=0)return null;if(!("TouchEvent"in u))return t;if(this instanceof TouchEvent)return a;if("PointerEvent"in u&&this instanceof PointerEvent)return this.pointerType=="touch"?a:t;var f=Date.now()<r+v?a:t;return Object.defineProperty(this,h,{value:f,writable:!1}),f},configurable:!0,enumerable:!0});function _(f){if(f in u&&!(!("length"in u[f])||u[f].length<1)){var E=u[f];u[f]=function(P,y){var C=y&&y.sourceCapabilities?y.sourceCapabilities:null;y&&delete y.sourceCapabilities;var T=new E(P,y);return Object.defineProperty(T,h,{value:C,writable:!1}),T},u[f].prototype=E.prototype}}for(var n=["UIEvent","MouseEvent","TouchEvent","InputEvent","CompositionEvent","FocusEvent","KeyboardEvent","WheelEvent","PointerEvent"],o=0;o<n.length;o++)_(n[o]);var m=Document.prototype.createEvent;Document.prototype.createEvent=function(f){var E=m.call(this,f);if(E instanceof UIEvent)return Object.defineProperty(E,h,{value:null,writable:!1}),E}})(globalThis);function J(u){var i=Q();return function(){var t=M.default(u),r;if(i){var l=M.default(this).constructor;r=b.default(t,arguments,l)}else r=t.apply(this,arguments);return B.default(this,r)}}function Q(){if(typeof Reflect=="undefined"||!b.default||b.default.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(b.default(Boolean,[],function(){})),!0}catch(u){return!1}}var Z=function(u){x.default(a,u);var i=J(a);function a(t){var r,l,h,e,v,_,n;return O.default(this,a),n=i.call(this),c.default(s.default(n),"element",null),c.default(s.default(n),"isMoving",!1),c.default(s.default(n),"onMouseDown",function(o){var m;n.disabledWhenFiresTouchEvents&&(m=o.sourceCapabilities)!==null&&m!==void 0&&m.firesTouchEvents||!n.enableMove||o.button!==n.mouseButtonOfMove||(n.isMoving=!0)}),c.default(s.default(n),"onMouseMove",function(o){!n.enableMove||!n.isMoving||n.emit("move",{x:o.movementX,y:o.movementY})}),c.default(s.default(n),"onMouseUp",function(){n.isMoving=!1}),c.default(s.default(n),"onWheel",function(o){var m={x:o.clientX,y:o.clientY};n.enableScale&&!!o.shiftKey==(n.mouseButtonOfScale==="shift-required")&&n.emit("scale",{ratio:o.deltaY>0?.9:1/.9,center:m}),n.enableRotate&&!!o.shiftKey!=(n.mouseButtonOfScale==="shift-required")&&n.emit("rotate",{ratio:o.deltaY>0?15*Math.PI/180:-(15*Math.PI)/180,center:m})}),c.default(s.default(n),"enableMove",void 0),c.default(s.default(n),"enableScale",void 0),c.default(s.default(n),"enableRotate",void 0),c.default(s.default(n),"mouseButtonOfMove",void 0),c.default(s.default(n),"mouseButtonOfScale",void 0),c.default(s.default(n),"disabledWhenFiresTouchEvents",void 0),n.enableMove=(r=t==null?void 0:t.enableMove)!==null&&r!==void 0?r:!0,n.enableScale=(l=t==null?void 0:t.enableScale)!==null&&l!==void 0?l:!0,n.enableRotate=(h=t==null?void 0:t.enableRotate)!==null&&h!==void 0?h:!0,n.disabledWhenFiresTouchEvents=(e=t==null?void 0:t.disabledWhenFiresTouchEvents)!==null&&e!==void 0?e:!1,n.mouseButtonOfMove=(v=t==null?void 0:t.mouseButtonOfMove)!==null&&v!==void 0?v:0,n.mouseButtonOfScale=(_=t==null?void 0:t.mouseButtonOfScale)!==null&&_!==void 0?_:"middle-button-only",n}return R.default(a,[{key:"attach",value:function(r){if(!r){console.error("[interact] element required");return}this.element=r,window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp),r.addEventListener("mousedown",this.onMouseDown),r.addEventListener("wheel",this.onWheel)}},{key:"detach",value:function(){var r,l;window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),(r=this.element)===null||r===void 0||r.removeEventListener("mousedown",this.onMouseDown),(l=this.element)===null||l===void 0||l.removeEventListener("wheel",this.onWheel),this.element=null}}]),a}(I.default);function V(u){var i=ee();return function(){var t=M.default(u),r;if(i){var l=M.default(this).constructor;r=b.default(t,arguments,l)}else r=t.apply(this,arguments);return B.default(this,r)}}function ee(){if(typeof Reflect=="undefined"||!b.default||b.default.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(b.default(Boolean,[],function(){})),!0}catch(u){return!1}}function L(u,i){return{x:i.x-u.x,y:i.y-u.y}}function g(u,i){return Math.sqrt(Math.pow(u.x-i.x,2)+Math.pow(u.y-i.y,2))}function q(){for(var u=0,i=0,a=arguments.length,t=new Array(a),r=0;r<a;r++)t[r]=arguments[r];return t.forEach(function(l){u+=l.x,i+=l.y}),{x:u/t.length,y:i/t.length}}var te=function(u){x.default(a,u);var i=V(a);function a(t){var r,l,h,e;return O.default(this,a),e=i.call(this),c.default(s.default(e),"element",null),c.default(s.default(e),"hasTouchStart",!1),c.default(s.default(e),"touchAPos",{x:-1,y:-1}),c.default(s.default(e),"touchBPos",{x:-1,y:-1}),c.default(s.default(e),"syncTouches",function(v){var _=$.default(v.touches,2),n=_[0],o=_[1];n&&(e.touchAPos.x=n.clientX,e.touchAPos.y=n.clientY),o&&(e.touchBPos.x=o.clientX,e.touchBPos.y=o.clientY)}),c.default(s.default(e),"onTouchStart",function(v){e.hasTouchStart=!0,v.preventDefault(),e.syncTouches(v)}),c.default(s.default(e),"onGlobalTouchStart",function(v){e.hasTouchStart&&(v.preventDefault(),e.syncTouches(v))}),c.default(s.default(e),"onTouchMove",function(v){var _=$.default(v.touches,2),n=_[0],o=_[1];if(!(!n||!e.hasTouchStart)){if(e.enableMove)if(o){var m=n.clientX-e.touchAPos.x,f=o.clientX-e.touchBPos.x,E=m+f;e.enableScale&&(E/=2),m*f>0&&(E=Math.abs(m)<Math.abs(f)?m:f);var P=n.clientY-e.touchAPos.y,y=o.clientY-e.touchBPos.y,C=P+y;e.enableScale&&(C/=2),P*y>0&&(C=Math.abs(P)<Math.abs(y)?P:y),e.emit("move",{x:E,y:C})}else e.emit("move",{x:n.clientX-e.touchAPos.x,y:n.clientY-e.touchAPos.y});if(n&&o&&(e.enableRotate||e.enableScale)){var T={x:n.clientX,y:n.clientY},w={x:o.clientX,y:o.clientY};if(e.enableScale&&e.emit("scale",{center:q(T,w,e.touchAPos,e.touchBPos),ratio:g(T,w)/g(e.touchAPos,e.touchBPos)}),e.enableRotate){var F=L(T,w),Y=L(e.touchAPos,e.touchBPos),j=Math.atan2(F.y,F.x)-Math.atan2(Y.y,Y.x);j>Math.PI&&(j-=Math.PI*2),j<-Math.PI&&(j+=Math.PI*2),e.emit("rotate",{center:q(T,w),ratio:j})}}e.syncTouches(v)}}),c.default(s.default(e),"onTouchEnd",function(v){e.syncTouches(v),v.touches.length===0&&(e.hasTouchStart=!1)}),c.default(s.default(e),"enableMove",void 0),c.default(s.default(e),"enableScale",void 0),c.default(s.default(e),"enableRotate",void 0),e.enableMove=(r=t==null?void 0:t.enableMove)!==null&&r!==void 0?r:!0,e.enableScale=(l=t==null?void 0:t.enableScale)!==null&&l!==void 0?l:!0,e.enableRotate=(h=t==null?void 0:t.enableRotate)!==null&&h!==void 0?h:!0,e}return R.default(a,[{key:"attach",value:function(r){this.element=r,this.element.addEventListener("touchstart",this.onTouchStart,{passive:!1}),window.addEventListener("touchstart",this.onGlobalTouchStart,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove),window.addEventListener("touchend",this.onTouchEnd)}},{key:"detach",value:function(){var r;(r=this.element)===null||r===void 0||r.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchstart",this.onGlobalTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),this.element=null}}]),a}(H.default);function ne(u){var i=re();return function(){var t=M.default(u),r;if(i){var l=M.default(this).constructor;r=b.default(t,arguments,l)}else r=t.apply(this,arguments);return B.default(this,r)}}function re(){if(typeof Reflect=="undefined"||!b.default||b.default.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(b.default(Boolean,[],function(){})),!0}catch(u){return!1}}var ue=function(u){x.default(a,u);var i=ne(a);function a(){return O.default(this,a),i.apply(this,arguments)}return R.default(a)}(I.default);d.Interact=ue,d.MouseFormatter=Z,d.TouchFormatter=te,Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
